FROM python:3.11.5-alpine

# gRPC Port
EXPOSE 50051
# HTTP Port
EXPOSE 8000

WORKDIR /app
COPY services/impulse_svc/. /app
COPY docker-run-migrations-impulse-svc.sh ./run-migrations.sh
RUN chmod +x run-migrations.sh

RUN pip install -r requirements.txt

CMD sh -c 'python manage.py grpcserver 0.0.0.0:50051 &' \
  && sh -c 'python manage.py runserver 0.0.0.0:80000'
